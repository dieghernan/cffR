---
title: "BibTeX and CFF"
subtitle: A potential crosswalk
bibliography: REFERENCES.bib
author: Diego Hernangómez
description: >-
  This article presents a crosswalk between BibTeX and Citation File Format 
  [@druskat_citation_2021], as it is performed by the cffr package 
  [@hernangomez2021].
abstract: >-
  This article presents a crosswalk between BibTeX and Citation File Format 
  [@druskat_citation_2021], as it is performed by the cffr package 
  [@hernangomez2021].
link-citations: yes
documentclass: article
output: 
  rmarkdown::html_vignette:
    toc: true
vignette: >
  %\VignetteIndexEntry{BibTeX and CFF}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = ""
)

options(width = 60)
```

## Citation

Please cite this article as:

```{r cit, echo=FALSE, results='asis'}
thisart <- bibentry("Article",
  title = "{BibTeX} and {CFF}, a potential crosswalk",
  key = "hernangomez2022",
  author = "Diego Hernangómez",
  journal = "The {cffr} package",
  year = 2022,
  volume = "Vignettes",
)
cat("  \n")
thisart
```

A BibTex entry for LaTeX users:

``` bibtex
@article{hernangomez2022,
    title        = {{BibTeX} and {CFF}, a potential crosswalk},
    author       = {Diego Hernangómez},
    year         = 2022,
    journal      = {The {cffr} package},
    volume       = {Vignettes}
}
```

## BibTeX and R

[BibTeX](https://en.wikipedia.org/wiki/BibTeX) is a well-known format for
storing references that may be reused by another software, like
[LaTeX](https://en.wikipedia.org/wiki/LaTeX "LaTeX"). BibTeX was created by
[Oren Patashnik](https://en.wikipedia.org/wiki/Oren_Patashnik "Oren Patashnik")
and [Leslie
Lamport](https://en.wikipedia.org/wiki/Leslie_Lamport "Leslie Lamport") back in
1985. An example structure of a BibTeX entry would be:

``` bibtex
@book{einstein1921,
    title        = {Relativity: The Special and the General Theory},
    author       = {Einstein, A.},
    year         = 1920,
    publisher    = {Henry Holt and Company},
    address      = {London, United Kingdom},
    isbn         = 9781587340925
}
```

On this case, the entry (identified as `einstein1921`) would refer to a book.
This entry then can be used on a document and include references to it.

On **R** [@R_2021], we can replicate this structure using the `bibentry()` and
`toBibtex()` functions:

```{r bibentry}

entry <- bibentry("Book",
  key = "einstein1921",
  title = "Relativity: The Special and the General Theory",
  author = person("A.", "Einstein"),
  year = 1920,
  publisher = "Henry Holt and Company",
  address = "London, United Kingdom",
  isbn = 9781587340925,
)

toBibtex(entry)
```

The final results of the entry as a text string would be parsed as[^1]:

[^1]: By default R Pandoc would generate the cite on the Chicago author-date
    format [@rmarkdowncookbook2020]

```{r echo=FALSE, results='asis'}

entry
```

## BibTeX definitions

@patashnik1988 provides a comprehensive explanation of the BibTeX formats. We
can distinguish between **Entries** and **Fields**.

### Entries {#entries}

Each entry type defines a different type of work. The 14 entry types defined on
BibTeX[^2] are:

[^2]: Other implementations similar to BibTeX, as
    [BibLaTeX](https://www.ctan.org/pkg/biblatex), expand the definitions of
    entries including other types as **online**, **software** or **dataset**. On
    BibTeX these entries should be reclassified to **misc**.

-   **\@article**: An article from a journal or magazine.
-   **\@book**: A book with an explicit publisher.
-   **\@booklet**: A work that is printed and bound, but without a named
    publisher or sponsoring institution.
-   **\@conference**: The same as **\@inproceedings**, included for Scribe
    compatibility.
-   **\@inbook**: A part of a book, which may be a chapter (or section or
    whatever) and/or a range of pages.
-   **\@incollection**: A part of a book having its own title.
-   **\@inproceedings**: An article in a conference proceedings.
-   **\@manual**: Technical documentation.
-   **\@mastersthesis**: A Master's thesis.
-   **\@misc**: Use this type when nothing else fits.
-   **\@phdthesis**: A PhD thesis.
-   **\@proceedings**: The proceedings of a conference.
-   **\@techreport**: A report published by a school or other institution,
    usually numbered within a series.
-   **\@unpublished**: A document having an author and title, but not formally
    published.

Regarding the entries, `bibentry()` **R** function does not implement
**\@conference** . However, we can replace that key by **\@inproceedings** given
that the definition is identical.

### Fields

As in the case of Entries, @patashnik1988 provides also a definition for each of
the possible standard BibTeX fields[^3]. An entry can include other fields that
would be ignored on the raw implementation of BibTeX:

[^3]: As in the case of the entries, other implementations based on BibTeX may
    recognize additional fields.

-   **address**: Usually the address of the **publisher** or other of
    **institution**.
-   **annote**: An annotation. It is not used by the standard bibliography
    styles, but may be used by others that produce an annotated bibliography.
-   **author**: The name(s) of the author(s), in the format described n the
    LaTeX book [@lamport86latex].
-   **booktitle**: Title of a book, part of which is being cited. For **\@book**
    entries, use the **title** field instead.
-   **chapter**: A chapter (or section or whatever) number.
-   **crossref**: The database key of the entry being cross referenced.
-   **edition**: The edition of a **\@book** - for example, "Second". This
    should be an ordinal, and should have the first letter capitalized, the
    standard styles convert to lower case when necessary.
-   **editor**: Name(s) of editor(s), typed as indicated in the LaTeX book
    [@lamport86latex]. If there is also an **author** field, then the editor
    field gives the editor of the book or collection in which the reference
    appears.
-   **howpublished**: How something strange has been published. The first word
    should be capitalized.
-   **institution**: The sponsoring institution of a technical report.
-   **journal**: A journal name.
-   **key**: Used for alphabetizing, cross referencing, and creating a label
    when the **author** information is missing.
-   **month**: The month in which the work was published or, for an unpublished
    work, in which it was written. You should use the standard three-letter
    abbreviation, as described in Appendix B.1.3 of the LaTeX book
    [@lamport86latex] (i.e. `jan, feb, mar`).
-   **note**: Any additional information that can help the reader. The first
    word should be capitalized.
-   **number**: The number of a journal, magazine, technical report, or of a
    work in a series. An issue of a journal or magazine is usually identified by
    its **volume**: and number; the organization that issues a technical report
    usually gives it a number; and sometimes books are given numbers in a named
    series.
-   **organization**: The organization that sponsors a **\@conference** or that
    publishes a manual.
-   **pages**: One or more page numbers or range of numbers, such as `42--111`
    or `7,41,73--97` or `43+`.
-   **publisher**: The publisher's name.
-   **school**: The name of the school where a thesis was written.
-   **series**: The name of a series or set of books. When citing an entire
    book, the **title** field gives its title and an optional **series** field
    gives the name of a series or multi-volume set in which the book is
    published.
-   **title**: The work's title.
-   **type**: The type of a technical report---for example, "Research Note".
-   **volume**: The volume of a journal or multivolume book.
-   **year**: The year of publication or, for an unpublished work, the year it
    was written. Generally it should consist of four numerals, such as `1984`.

There is a strict relation between Entries and Fields on BibTeX. Depending on
the type of entries, some fields are required while others are optional or even
ignored. On the following table, required field are flagged as **\*** and
optional fields are flagged as **-**. Fields on parenthesis **()** denotes that
there are some degree of optionality on the requirement of the field, see
@patashnik1988 for more information.

```{r entry_fields, echo=FALSE}

bibtex_field_entry <- read.csv(system.file("extdata/bibtex_field_entry.csv",
  package = "cffr"
),
sep = ","
)

t1 <- bibtex_field_entry[, c(1:7)]

knitr::kable(t1,
  col.names = gsub("\\.", ",", names(t1)),
  align = c("l", rep("c", 6)),
  caption = "BibTeX, required fields by entry"
)

t2 <- bibtex_field_entry[, c(1, 8:13)]

knitr::kable(t2,
  col.names = gsub("\\.", ",", names(t2)),
  align = c("l", rep("c", 6)),
  caption = "(cont) BibTeX, required fields by entry"
)
```

It can be observed that just a subset of fields is required in any of the
Entries. For example, **title**, **year** and **author** are either required or
optional on almost every entry, while **crossref**, **annote** or **key** are
never required.

## Citation File Format

[Citation File Format (CFF](https://citation-file-format.github.io/))
[@druskat_citation_2021] are plain text files with human- and machine-readable
citation information for software (and datasets). Among the [valid keys of
CFF](https://github.com/citation-file-format/citation-file-format/blob/main/schema-guide.md#valid-keys)
there are two keys, `preferred-citation` and `references` of special interest
for citing and referring to related works[^4]:

[^4]: See [Guide to Citation File Format schema version
    1.2.0](https://github.com/citation-file-format/citation-file-format/blob/main/schema-guide.md#preferred-citation).

-   **`preferred-citation`**: A reference to another work that should be cited
    instead of the software or dataset itself.

-   **`references`**: Reference(s) to other creative works. Similar to a list of
    references in a paper, references of the software or dataset may include
    other software (dependencies), or other research products that the software
    or dataset builds on, but not work describing the software or dataset.

These two keys are expected to be
[`definition.reference`](https://github.com/citation-file-format/citation-file-format/blob/main/schema-guide.md#definitionsreference)
objects, therefore they may contain the following keys:

```{r refkeys, echo=FALSE, message=FALSE, warning=FALSE, results='asis'}
library(cffr)

# Fill with whites
l <- c(cff_schema_definitions_refs(), rep("", 4))


refkeys <- matrix(l, ncol = 5, byrow = TRUE)

knitr::kable(refkeys,
  caption = "Valid keys on CFF `definition-reference` objects"
)
```

These keys are the equivalent to the fields of BibTeX (see [Fields]), with the
exception of the key **type**. On CFF, this key defines the type of work[^5],
therefore this is the equivalent to the BibteX entries (see
[Entries](#entries)).

[^5]: See a complete list of possible values of CFF type on the [Guide to
    Citation File Format schema version
    1.2.0](https://github.com/citation-file-format/citation-file-format/blob/main/schema-guide.md#definitionsreferencetype).

## Proposed crosswalk

The **cffr** package [@hernangomez2021] provides utilities from converting
BibTeX entries (via the **R** base function `bibentry()`) to CFF files and
vice-versa. This section describes how the conversion between both formats have
been implemented. This crosswalk is based partially on
@Haines_Ruby_CFF_Library_2021[^6].

[^6]: Note that this software performs only the conversion from CFF to BibTeX,
    however **cffr** can perform the conversion in both directions.

On the following two section I present an overview of the proposed mapping
between the Entries and Fields of BibTeX and the CFF keys. After this initial
mapping, I propose further transformations to improve the compatibility between
both systems using different [Entry Models].

### Entry/Type crosswalk

For converting general BibTeX entries to CFF types, the following crosswalk is
proposed:

| BibTeX Entry        | Value of CFF key: type | Notes              |
|---------------------|------------------------|--------------------|
| **\@article**       | article                |                    |
| **\@book**          | book                   |                    |
| **\@booklet**       | pamphlet               |                    |
| **\@conference**    | conference-paper       |                    |
| **\@inbook**        | book                   | See [Entry Models] |
| **\@incollection**  | generic                | See [Entry Models] |
| **\@inproceedings** | conference-paper       |                    |
| **\@manual**        | manual                 |                    |
| **\@mastersthesis** | thesis                 | See [Entry Models] |
| **\@misc**          | generic                |                    |
| **\@phdthesis**     | thesis                 | See [Entry Models] |
| **\@proceedings**   | proceedings            |                    |
| **\@techreport**    | report                 |                    |
| **\@unpublished**   | unpublished            |                    |

: Entry/Type crosswalk: From BibteX to CFF

Also, given that CFF provides with a [wide range of allowed
values](https://github.com/citation-file-format/citation-file-format/blob/main/schema-guide.md#definitionsreferencetype)
on type, the following conversion would be performed from CFF to BibTeX:

| Value of CFF key: type | BibTeX Entry                      | Notes                                         |
|------------------------|-----------------------------------|-----------------------------------------------|
| book                   | **\@book** **/ \@inbook**         | See [Entry Models]                            |
| conference             | **\@inproceedings**               |                                               |
| conference-paper       | **\@inproceedings**               |                                               |
| magazine-article       | **\@article**                     |                                               |
| manual                 | **\@manual**                      |                                               |
| n ewspaper-article     | **\@article**                     |                                               |
| pamphlet               | **\@booklet**                     |                                               |
| proceedings            | **\@proceedings**                 |                                               |
| report                 | **\@techreport**                  |                                               |
| thesis                 | **\@mastersthesis / \@phdthesis** | See [Entry Models]                            |
| unpublished            | **\@unpublished**                 |                                               |
| generic                | **\@misc / \@incollection**       | Under specific conditions, see [Entry Models] |
| \<any other value>     | **\@misc**                        |                                               |

: Entry/Type crosswalk: From CFF to BibteX

### Fields/Key crosswalk

There is a large degree of similarity between the definition and names of some
BibTeX fields and CFF keys. On the following cases, the equivalence is almost
straightforward:

| BibTeX Field     | CFF key            |
|------------------|--------------------|
| **address**      | See [Entry Models] |
| ***annote***     | \-                 |
| **author**       | authors            |
| **booktitle**    | collection-title   |
| **chapter**      | section            |
| ***crossref***   | \-                 |
| **edition**      | edition            |
| **editor**       | editors            |
| **howpublished** | medium             |
| **institution**  | See [Entry Models] |
| **journal**      | journal            |
| ***key***        | \-                 |
| **month**        | month              |
| **note**         | notes              |
| **number**       | issue              |
| **organization** | See [Entry Models] |
| **pages**        | start & end        |
| **publisher**    | publisher          |
| **school**       | See [Entry Models] |
| **series**       | See [Entry Models] |
| **title**        | title              |
| ***type***       | \-                 |
| **volume**       | volume             |
| **year**         | year               |

: BibTeX - CFF Field/Key crosswalk

Additionally, there are other additional CFF keys that have a correspondence
with BibLaTeX fields. We propose also to include these fields on the
crosswalk[^7], although they are not part of the core BibTeX fields definition.

[^7]: See @biblatexcheatsheet for a preview of the accepted BibLaTeX fields.

| BibLaTeX Field | CFF key        |
|----------------|----------------|
| **abstract**   | abstract       |
| **date**       | date-published |
| **doi**        | doi            |
| **file**       | filename       |
| **isbn**       | isbn           |
| **issn**       | issn           |
| **issuetitle** | issue-title    |
| **pagetotal**  | pages          |
| **translator** | translators    |
| **url**        | url            |
| **urldate**    | date-accessed  |
| **version**    | version        |

: BibLaTeX - CFF Field/Key crosswalk

## Entry Models

This section presents the specific mapping proposed for each of the BibTeX
entries, providing further information on how each field is treated.

### Article

The crosswalk of \@Article does not require any special treatment.

+---------------+---------------+---------------------------------------------+
| BibTeX        | CFF           | Note                                        |
+===============+===============+=============================================+
| **\@Article** | article       | When converting CFF to BibTeX, CFF keys     |
|               |               | *magazine-article* and *newspaper-article*  |
|               |               | are converted to **\@Article**.             |
+---------------+---------------+---------------------------------------------+
| **author\***  | authors       |                                             |
+---------------+---------------+---------------------------------------------+
| **title\***   | title         |                                             |
+---------------+---------------+---------------------------------------------+
| **journal\*** | journal       |                                             |
+---------------+---------------+---------------------------------------------+
| **year\***    | year          |                                             |
+---------------+---------------+---------------------------------------------+
| **volume**    | volume        |                                             |
+---------------+---------------+---------------------------------------------+
| **number**    | issue         |                                             |
+---------------+---------------+---------------------------------------------+
| **pages**     | start and end | Separated by `--,` i.e,                     |
|               |               |                                             |
|               |               | pages = `3--5` (BibTeX)                     |
|               |               |                                             |
|               |               | would be parsed as                          |
|               |               |                                             |
|               |               | `start: 3`                                  |
|               |               |                                             |
|               |               | `end: 5`                                    |
|               |               |                                             |
|               |               | on CFF                                      |
+---------------+---------------+---------------------------------------------+
| **month**     | month         | As a fallback, **month** could be extracted |
|               |               | also from **date** (BibLaTeX field)/        |
|               |               | date-published (CFF)                        |
+---------------+---------------+---------------------------------------------+
| **note**      | notes         |                                             |
+---------------+---------------+---------------------------------------------+

: Article model

**Examples**

[*BibTeX entry*]{.ul}

``` bibtex
@Article{1981:surveys:bernstein,
  author =       "P. A. Bernstein and N. Goldman",
  title =        "Concurrency Control in Distributed Database Systems",
  journal =      "ACM Computing Surveys",
  publisher =    "ACM Press",
  address =      "New York, NY, USA",
  year =         "1981",
  volume =       "13",
  month =        "jun",
  number =       "2",
  pages =        "185--221",
  keywords =     "Concurrency control; deadlock; distributed database
                 management systems; locking; serializability;
                 synchronization; timestamp ordering; timestamps;
                 two-phase commit; two-phase locking",
  annote =       "unsupported",
}
```

[*CFF entry*]{.ul}

```{r echo=FALSE}

bib <- bibentry("Article",
  author = "P. A. Bernstein and N. Goldman",
  title = "Concurrency Control in Distributed Database Systems",
  journal = "ACM Computing Surveys",
  publisher = "ACM Press",
  address = "New York, NY, USA",
  year = "1981",
  volume = "13",
  month = "jun",
  number = "2",
  pages = "185--221",
  keywords = "Concurrency control; deadlock; distributed database
                 management systems; locking; serializability;
                 synchronization; timestamp ordering; timestamps;
                 two-phase commit; two-phase locking",
  annote = "unsupported",
)

cff_parse_citation(bib)
```

[*From CFF to BibTeX*]{.ul}

```{r echo=FALSE}
toBibtex(cff_to_bibtex(cff_parse_citation(bib)))
```

### Book/InBook

In terms of field required on BibTeX, the only difference between **\@Book** and
**\@InBook** is that the latter requires also a **chapter** or **pages**, while
for \@Book these fields are not even optional. So we propose here to identify an
**\@InBook** on CFF as a book with chapter and start-end fields (CFF).

Another specificities are that **series** field is mapped to collection-title
and **address** is mapped as the address of the publisher (CFF).

| BibTeX          | CFF                           | Note                                                                                                      |
|-----------------|-------------------------------|-----------------------------------------------------------------------------------------------------------|
| **\@Book**      | book                          |                                                                                                           |
| **\@InBook**    | book                          | For identifying an \@InBook in CFF, assess if **chapter** or **pages**/start-end information is available |
| **author\***    | authors                       |                                                                                                           |
| **editor\***    | editors                       |                                                                                                           |
| **title\***     | title                         |                                                                                                           |
| **publisher\*** | publisher                     |                                                                                                           |
| **year\***      | year                          |                                                                                                           |
| **chapter\***   | section                       | Only required on **\@InBook**                                                                             |
| **pages\***     | start and end                 | Only required on **\@InBook**                                                                             |
| **volume**      | volume                        |                                                                                                           |
| **number**      | issue                         |                                                                                                           |
| **series**      | collection-title              |                                                                                                           |
| **address**     | address property of publisher | As a fallback, the field location (CFF) can be used                                                       |
| **edition**     | edition                       |                                                                                                           |
| **month**       | month                         | As a fallback, **month** could be extracted also from **date** (BibLaTeX field)/ date-published (CFF)     |
| **note**        | notes                         |                                                                                                           |

: Book/InBook model

**Examples: Book**

[*BibTeX entry*]{.ul}

``` bibtex
@book{10.5555/218623,
    editor       = {Abramsky, S. and Gabbay, Dov M. and Maibaum, T. S. E.},
    title        = {Handbook of Logic in Computer Science: Semantic Modelling},
    year         = 1995,
    volume       = 4,
    isbn         = {0198537808},
    publisher    = {Oxford University Press, Inc.},
    address      = {USA}
}
```

[*CFF entry*]{.ul}

```{r echo=FALSE}

bib <- bibentry("Book",
  editor = "S. Abramsky and Dov M. Gabbay and T. S. E. Maibaum",
  title = "Handbook of Logic in Computer Science: Semantic Modelling",
  volume = 4,
  year = 1995,
  isbn = "0198537808",
  publisher = "Oxford University Press, Inc.",
  address = "USA"
)

cff_parse_citation(bib)
```

[*From CFF to BibTeX*]{.ul}

```{r}
toBibtex(cff_to_bibtex(cff_parse_citation(bib)))
```

**Examples: InBook**

[*BibTeX entry*]{.ul}

``` bibtex
@inbook{10.5555/218623-1,
    author       = {Winskel, Glynn and Nielsen, Mogens},
    chapter      = {Models for Concurrency},
    editor       = {Abramsky, S. and Gabbay, Dov M. and Maibaum, T. S. E.},
    title        = {Handbook of Logic in Computer Science: Semantic Modelling},
    year         = 1995,
    volume       = 4,
    isbn         = {0198537808},
    publisher    = {Oxford University Press, Inc.},
    address      = {USA}
}
```

[*CFF entry*]{.ul}

```{r echo=FALSE}

bib <- bibentry("InBook",
  author = "Glynn Winskel and Mogens Nielsen",
  chapter = "Models for Concurrency",
  editor = "S. Abramsky and Dov M. Gabbay and T. S. E. Maibaum",
  title = "Handbook of Logic in Computer Science: Semantic Modelling",
  year = 1995,
  volume = 4,
  isbn = "01985378082",
  publisher = "Oxford University Press, Inc.",
  address = "USA"
)

cff_parse_citation(bib)
```

[*From CFF to BibTeX*]{.ul}

```{r echo=FALSE}
toBibtex(cff_to_bibtex(cff_parse_citation(bib)))
```

## References
